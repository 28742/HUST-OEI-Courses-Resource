# 第二章 处理器管理

### 处理器状态与转换

> **内核态**（管态）：操作系统运行系统管理程序时所处的状态
>
> **用户态**（目态）：操作系统运行应用程序时所处的状态
>
> **用户态——内核态**：程序请求系统调用，中断（外中断），异常（内中断）

### 指令系统

> **特权指令**：仅在内核态可以使用的指令，如改变机器状态，修改寄存器内容，启动设备IO等（多为<u>修改加载启动</u>类的操作）
>
> **非特权指令**：可在用户态（目态）使用，包括访管指令

### 程序状态字PSW

> **作用**：储存程序运行时的动态信息实现中断前后程序状态的保存和恢复：如当前处于<u>内核态还是用户态</u>，<u>下一条待执行指令位置</u>

### 中断分类

> **内中断（异常）**：CPU发现错误后发起的中断，通常是由于发生了错误等
>
> **外中断（中断）**：中断信号来自处理器之外，存在优先级以及可屏蔽性
>
> **区别**：异常与CPU是同步的不可阻塞且多为一重，中断与CPU是异步的可以阻塞且可以嵌套

### 中断处理流程

> **中断向量**：中断处理程序的入口地址，即<u>偏移地址IP+段地址CS</u>
>
> **流程**：中断源提供中断向量给CPU，
>
> ​				保护现场（暂停并保存当前程序的PSW至核心栈），
>
> ​				根据中断向量执行中断处理程序（内核态），
>
> ​				恢复现场（恢复原PSW，继续执行程序）

### 进程Process

> **目的**：<u>多道程序系统</u>下描述系统内部动态情况，抽象化CPU上<u>程序活动规律</u>
>
> ​				<u>刻画程序的并发性，解决资源的共享性（可再入程序：可被多次调用，可再用程序：仅可被一次调用）</u>
>
> ​				一个程序（PSW标识）可以被多次调用生成多个进程，一个进程（PCB标识）唯一对应一个程序
>
> **定义**：是CPU调度和资源分配的基本单位
>
> **状态及转换**：运行态，就绪态（只差CPU），等待态（差CPU，也差其它设备）          
>
> ​							  挂起态（进程被暂停保存移出内存，以平滑系统负荷）![image-20210528183119602](C:\Users\13675\AppData\Roaming\Typora\typora-user-images\image-20210528183119602.png)
>
> **进程管理**：CPU对进程的管理通过控制与进程一一对应的**进程控制块PCB**来实现，存在进程对应的PCB表
>
> **进程上下文**：进程物理实体以及其对应运行环境
>
> **进程切换**：更换PCB索引，切换进程上下文

### 线程Thread

> **定义**：是CPU调度的真正的基本单位（多CPU时可将进程不同块的调度执行变得并发提高系统效率），资源占有单位仍然是进程
>
> ​				<u>进程：资源集合+线程集合（执行信息）</u>
>
> **状态**：运行，就绪，等待，中止，（不存在挂起，非资源占有单位，进程挂起则其所有线程均会移出内存）
>
> **分类**：内核级KLT：线程管理工作由内核（对应系统管理程序）完成
>
> ​			  用户级ULT：线程管理工作由应用程序完成，与内核级区别在于性能
>
> ​			  混合式：支持以上两种

### 作业调度算法

> **先来先服务FCFS**
>
> **最短作业优先SJF**
>
> **最短剩余时间优先SRTF**
>
> **最高响应比优先HRRF**：<u>响应比：周转/处理</u>，注意：处理：预测用时（提前给出要求），<u>带权周转：周转/运行</u>，运行：真实用时
>
> ​													响应比与带权周转一般数值相同
>
> **优先级调度**
>
> **时间片轮转**

